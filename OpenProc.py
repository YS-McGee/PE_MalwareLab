"""
HANDLE OpenProcess(
  DWORD dwDesiredAccess,
  BOOL  bInheritHandle,
  DWORD dwProcessId
);
"""

import ctypes

k_handle = ctypes.WinDLL("Kernel32.dll")                    # creates handle to dll

PROCESS_ALL_ACCESS = ( 0x000F0000 | 0x00100000 | 0xFFF  )   # value for all_access

dwDesiredAccess = PROCESS_ALL_ACCESS                        # assigning parametre
bInheritHandle = False                                      # assigning parametre
#dwProcessId = int(input("PID: "))                          # ask for input PID
dwProcessId = 9764                                          # idk dec or hex
print("dwProcessId: ", dwProcessId, type(dwProcessId))      # testing

response = k_handle.OpenProcess(dwDesiredAccess,            # calling OpenProcess and pass para
                                bInheritHandle, 
                                dwProcessId)
error = k_handle.GetLastError()                             # catch error code (inspect doc sys error code)
if error != 0:
    print("Error Code: {0}".format(error))
    exit(1)
else : print("Response: ", response)

if response <= 0:                                           # check handle creation successness
    print("Handle was not created.")
else: print("Handle was created.")